{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Desktop/tidy-up/tidy-up/src/Components/AdminUploadReports.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { db, storage } from \"../Firebase/Firebase\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction AdminUploadReports(props) {\n  _s();\n\n  const {\n    currentTest\n  } = props;\n  console.log(currentTest);\n  const nameRef = useRef();\n  const emailRef = useRef();\n  const ageRef = useRef();\n  const drnameRef = useRef();\n  const phoneRef = useRef();\n  const genderRef = useRef();\n  const dateRef = useRef();\n  const slotRef = useRef();\n  const history = useHistory();\n  const [photoUrl, setPhotoUrl] = useState(\"\");\n  const [photo, setPhoto] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [uploadMsg, setUploadMsg] = useState(\"\");\n  const [uploadError, setUploadError] = useState(\"\");\n\n  function handleUpload(e) {\n    if (e.target.files[0]) {\n      setPhoto(e.target.files[0]);\n    }\n  }\n\n  async function uploadFile() {\n    if (!photo) {\n      setUploadMsg(\"\");\n      setUploadError(\"Please select a file\");\n      return;\n    }\n\n    setLoading(true);\n    const date = new Date().toISOString();\n    const name = photo.name + \"_\" + date;\n    var allowedExtensions = /(\\.pdf)$/i;\n\n    if (!allowedExtensions.exec(photo.name)) {\n      setUploadMsg(\"\");\n      setUploadError(\"Please upload a .pdf file\");\n      setLoading(false);\n      return;\n    }\n\n    setLoading(true);\n    const uploadTask = storage.ref(`images/${name}`).put(photo);\n    uploadTask.on(\"state_changed\", snapshot => {}, error => {\n      console.log(error);\n      setUploadError(error);\n    }, () => {\n      storage.ref(\"images\").child(name).getDownloadURL().then(url => {\n        setPhotoUrl(url);\n        setLoading(false);\n        setUploadError(\"\");\n        setUploadMsg(\"Photo uploaded\");\n        const response = db.collection(\"current_tests\").doc(currentTest.id).update({\n          pdfUrl: url\n        });\n        console.log(response);\n        console.log(\"this shit worked\");\n        db.collection(\"users\").doc(currentTest.userId).collection(\"tests\").doc(currentTest.id).update({\n          pdfUrl: url\n        });\n        console.log(response);\n        console.log(\"this worked in users\");\n        db.collection(\"current_tests\").doc(currentTest.id).delete().then(() => {\n          console.log(\"Document successfully deleted!\");\n        }).catch(error => {\n          console.error(\"Error removing document: \", error);\n        });\n        setLoading(false);\n        history.push(\"/CurrentTests\");\n      });\n    });\n    console.log(\"pdf uploaded\");\n  }\n\n  const [ProfileInfo, setProfileInfo] = useState({});\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await db.collection(\"current_tests\").doc(currentTest.id).get();\n        console.log(\"response\", response);\n        let data = {\n          title: \"not found\"\n        };\n\n        if (response.exists) {\n          console.log(\"found it\");\n          data = response.data();\n          console.log(data);\n        }\n\n        setProfileInfo(data); // setLoading(false);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    fetchData();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"contact-clean\",\n        children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n          \"aria-label\": \"breadcrumb\",\n          children: /*#__PURE__*/_jsxDEV(\"ol\", {\n            className: \"breadcrumb\",\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"breadcrumb-item\",\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                to: \"/CurrentTests\",\n                children: \"Current Tests\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"breadcrumb-item active\",\n              \"aria-current\": \"page\",\n              children: \"Upload Reports\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"bg-light border rounded\",\n          style: {\n            background: \"rgb(248,248,249)\"\n          },\n          children: [currentTest.location === \"home\" && /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-center\",\n            children: \"Home Visit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 15\n          }, this), currentTest.location === \"centre\" && /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-center\",\n            children: \"Centre Visit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"text\",\n              name: \"name\",\n              placeholder: \"Name\",\n              defaultValue: ProfileInfo.name,\n              ref: nameRef,\n              disabled: \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"input-group mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"input-group-text\",\n              for: \"inputGroupSelect01\",\n              children: \"Gender\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"form-select\",\n              id: \"inputGroupSelect01\",\n              ref: genderRef,\n              Value: ProfileInfo.gender,\n              disabled: \"true\",\n              children: /*#__PURE__*/_jsxDEV(\"option\", {\n                children: ProfileInfo.gender\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"number\",\n              name: \"Age\",\n              placeholder: \"Age\",\n              min: \"10\",\n              max: \"100\",\n              ref: ageRef,\n              defaultValue: ProfileInfo.age,\n              disabled: \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"email\",\n              name: \"email\",\n              placeholder: \"Email\",\n              ref: emailRef,\n              defaultValue: ProfileInfo.email,\n              disabled: \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"number\",\n              name: \"phone\",\n              placeholder: \"Phone\",\n              inputMode: \"tel\",\n              defaultValue: ProfileInfo.phone,\n              disabled: \"true\",\n              ref: phoneRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"text\",\n              name: \"dr-name\",\n              placeholder: \"Ref Doctor's Name\",\n              ref: drnameRef,\n              defaultValue: ProfileInfo.doctorname,\n              disabled: \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-inline-flex mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"date\",\n              ref: dateRef,\n              style: {\n                paddingRight: \"12px\",\n                paddingLeft: \"12px\",\n                width: \"200px\"\n              },\n              defaultValue: ProfileInfo.date,\n              disabled: \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"input-group mb-3\",\n            children: /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"form-select\",\n              id: \"inputGroupSelect04\",\n              \"aria-label\": \"Example select with button addon\",\n              ref: slotRef,\n              disabled: \"true\",\n              children: /*#__PURE__*/_jsxDEV(\"option\", {\n                children: ProfileInfo.slot\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              onChange: handleUpload,\n              className: \"form-control\",\n              type: \"file\",\n              accept: \".pdf\",\n              name: \"Upload Report\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 15\n            }, this), !loading && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-primary\",\n              onClick: uploadFile,\n              disabled: loading,\n              children: \"Upload File\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 17\n            }, this), loading && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-primary\",\n              disabled: loading,\n              children: \"Uploading Please Wait\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AdminUploadReports, \"Ed03m+zpxV1scRCCvKYtKUyB5GI=\", false, function () {\n  return [useHistory];\n});\n\n_c = AdminUploadReports;\nexport default AdminUploadReports;\n\nvar _c;\n\n$RefreshReg$(_c, \"AdminUploadReports\");","map":{"version":3,"sources":["/Users/mac/Desktop/tidy-up/tidy-up/src/Components/AdminUploadReports.js"],"names":["React","useState","useRef","useEffect","db","storage","Link","useHistory","AdminUploadReports","props","currentTest","console","log","nameRef","emailRef","ageRef","drnameRef","phoneRef","genderRef","dateRef","slotRef","history","photoUrl","setPhotoUrl","photo","setPhoto","loading","setLoading","uploadMsg","setUploadMsg","uploadError","setUploadError","handleUpload","e","target","files","uploadFile","date","Date","toISOString","name","allowedExtensions","exec","uploadTask","ref","put","on","snapshot","error","child","getDownloadURL","then","url","response","collection","doc","id","update","pdfUrl","userId","delete","catch","push","ProfileInfo","setProfileInfo","fetchData","get","data","title","exists","err","background","location","gender","age","email","phone","doctorname","paddingRight","paddingLeft","width","slot"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport {\n  db,\n  storage,\n} from \"../Firebase/Firebase\";\nimport { Link, useHistory } from \"react-router-dom\";\n\nfunction AdminUploadReports(props) {\n  const { currentTest } = props;\n  console.log(currentTest);\n  const nameRef = useRef();\n  const emailRef = useRef();\n  const ageRef = useRef();\n  const drnameRef = useRef();\n  const phoneRef = useRef();\n  const genderRef = useRef();\n\n  const dateRef = useRef();\n  const slotRef = useRef();\n\n  const history = useHistory();\n\n  const [photoUrl, setPhotoUrl] = useState(\"\");\n  const [photo, setPhoto] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [uploadMsg, setUploadMsg] = useState(\"\");\n  const [uploadError, setUploadError] = useState(\"\");\n\n  function handleUpload(e) {\n    if (e.target.files[0]) {\n      setPhoto(e.target.files[0]);\n    }\n  }\n\n  async function uploadFile() {\n    if (!photo) {\n      setUploadMsg(\"\");\n      setUploadError(\"Please select a file\");\n      return;\n    }\n\n    setLoading(true);\n    const date = new Date().toISOString();\n    const name = photo.name + \"_\" + date;\n\n    var allowedExtensions = /(\\.pdf)$/i;\n    if (!allowedExtensions.exec(photo.name)) {\n      setUploadMsg(\"\");\n      setUploadError(\"Please upload a .pdf file\");\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    const uploadTask = storage.ref(`images/${name}`).put(photo);\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {},\n      (error) => {\n        console.log(error);\n        setUploadError(error);\n      },\n      () => {\n        storage\n          .ref(\"images\")\n          .child(name)\n          .getDownloadURL()\n          .then((url) => {\n            setPhotoUrl(url);\n            setLoading(false);\n            setUploadError(\"\");\n            setUploadMsg(\"Photo uploaded\");\n            const response = db\n              .collection(\"current_tests\")\n              .doc(currentTest.id)\n              .update({ pdfUrl: url });\n            console.log(response);\n            console.log(\"this shit worked\");\n            db\n              .collection(\"users\")\n              .doc(currentTest.userId)\n              .collection(\"tests\")\n              .doc(currentTest.id)\n              .update({ pdfUrl: url });\n            console.log(response);\n            console.log(\"this worked in users\");\n            db\n              .collection(\"current_tests\")\n              .doc(currentTest.id)\n              .delete()\n              .then(() => {\n                console.log(\"Document successfully deleted!\");\n              })\n              .catch((error) => {\n                console.error(\"Error removing document: \", error);\n              });\n            setLoading(false);\n            history.push(\"/CurrentTests\");\n          });\n      }\n    );\n    console.log(\"pdf uploaded\");\n  }\n  const [ProfileInfo, setProfileInfo] = useState({});\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await db\n          .collection(\"current_tests\")\n          .doc(currentTest.id)\n          .get();\n\n        console.log(\"response\", response);\n\n        let data = { title: \"not found\" };\n\n        if (response.exists) {\n          console.log(\"found it\");\n          data = response.data();\n          console.log(data);\n        }\n\n        setProfileInfo(data);\n        // setLoading(false);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    fetchData();\n  }, []);\n  return (\n    <div>\n      <div>\n        <section className=\"contact-clean\">\n          <nav aria-label=\"breadcrumb\">\n            <ol className=\"breadcrumb\">\n              <li className=\"breadcrumb-item\">\n                <Link to=\"/CurrentTests\">Current Tests</Link>\n              </li>\n\n              <li className=\"breadcrumb-item active\" aria-current=\"page\">\n                Upload Reports\n              </li>\n            </ol>\n          </nav>\n          <form\n            className=\"bg-light border rounded\"\n   \n            style={{ background: \"rgb(248,248,249)\" }}\n          >\n            {currentTest.location === \"home\" && (\n              <h2 className=\"text-center\">Home Visit</h2>\n            )}\n            {currentTest.location === \"centre\" && (\n              <h2 className=\"text-center\">Centre Visit</h2>\n            )}\n            <div className=\"form-group mb-3\">\n              <input\n                className=\"form-control\"\n                type=\"text\"\n                name=\"name\"\n                placeholder=\"Name\"\n              \n                defaultValue={ProfileInfo.name}\n                ref={nameRef}\n                disabled=\"true\"\n              />\n            </div>\n            <div className=\"input-group mb-3\">\n              <label className=\"input-group-text\" for=\"inputGroupSelect01\">\n                Gender\n              </label>\n              <select\n                className=\"form-select\"\n                id=\"inputGroupSelect01\"\n                ref={genderRef}\n                Value={ProfileInfo.gender}\n                disabled=\"true\"\n              >\n                <option>{ProfileInfo.gender}</option>\n              </select>\n            </div>\n            <div className=\"form-group mb-3\">\n              <input\n                className=\"form-control\"\n                type=\"number\"\n                name=\"Age\"\n                placeholder=\"Age\"\n                min=\"10\"\n                max=\"100\"\n                ref={ageRef}\n                defaultValue={ProfileInfo.age}\n                disabled=\"true\"\n              />\n            </div>\n            <div className=\"form-group mb-3\">\n              <input\n                className=\"form-control\"\n                type=\"email\"\n                name=\"email\"\n                placeholder=\"Email\"\n                ref={emailRef}\n                defaultValue={ProfileInfo.email}\n                disabled=\"true\"\n              />\n            </div>\n            <div className=\"form-group mb-3\">\n              <input\n                className=\"form-control\"\n                type=\"number\"\n                name=\"phone\"\n                placeholder=\"Phone\"\n                inputMode=\"tel\"\n                defaultValue={ProfileInfo.phone}\n                disabled=\"true\"\n                ref={phoneRef}\n              />\n            </div>\n            <div className=\"form-group mb-3\">\n              <input\n                className=\"form-control\"\n                type=\"text\"\n                name=\"dr-name\"\n                placeholder=\"Ref Doctor's Name\"\n                ref={drnameRef}\n                defaultValue={ProfileInfo.doctorname}\n                disabled=\"true\"\n              />\n            </div>\n\n            <div className=\"d-inline-flex mb-3\">\n              <input\n                className=\"form-control\"\n                type=\"date\"\n                ref={dateRef}\n                style={{\n                  paddingRight: \"12px\",\n                  paddingLeft: \"12px\",\n                  width: \"200px\",\n                }}\n                defaultValue={ProfileInfo.date}\n                disabled=\"true\"\n              />\n            </div>\n            <div className=\"input-group mb-3\">\n              <select\n                className=\"form-select\"\n                id=\"inputGroupSelect04\"\n                aria-label=\"Example select with button addon\"\n                ref={slotRef}\n                disabled=\"true\"\n              >\n                <option>{ProfileInfo.slot}</option>\n              </select>\n            </div>\n            <div className=\"form-group mb-3\">\n              <input\n                onChange={handleUpload}\n                className=\"form-control\"\n                type=\"file\"\n                accept=\".pdf\"\n                name=\"Upload Report\"\n              />\n              {!loading && (\n                <button\n                  className=\"btn btn-primary\"\n                  onClick={uploadFile}\n                  disabled={loading}\n                >\n                  Upload File\n                </button>\n              )}\n              {loading && (\n                <button className=\"btn btn-primary\" disabled={loading}>\n                  Uploading Please Wait\n                </button>\n              )}\n            </div>\n          </form>\n        </section>\n      </div>\n    </div>\n  );\n}\n\nexport default AdminUploadReports;\n"]},"metadata":{},"sourceType":"module"}